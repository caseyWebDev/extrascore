/*!
Extrascore (requires jQuery and Underscore)
by Casey Foster (caseywebdev.com)
*/(function(){var $,__slice=[].slice;(typeof Extrascore=="undefined"||Extrascore===null)&&typeof jQuery!="undefined"&&jQuery!==null&&typeof _!="undefined"&&_!==null&&($=jQuery,window.Extrascore={mixins:{mass:function(){var e,t,n,r,i,s;t=arguments[0],n=arguments[1],e=3<=arguments.length?__slice.call(arguments,2):[],s=[];for(i in n)r=n[i],s.push(r!=null?typeof r[t]=="function"?r[t].apply(r,e):void 0:void 0);return s},init:function(e){var t;return t=function(e){return _.mass("load",e),_.update(e)},_.mass("init",e),$(function(){return t(e)})},update:function(e){return _.mass("update",e!=null?e:Extrascore.extensions)},clean:function(e,t){return t==null&&(t={}),t=_.extend({delimiter:" ",alphanumeric:!1,downcase:!1},t),e+="",t.downcase&&(e=e.toLowerCase()),t.alphanumeric&&(e=e.replace(/'/g,"").replace(/[^\w\s]|_/g," ")),$.trim(e.replace(/\s+/g," ")).replace(/\s/g,t.delimiter)},urlize:function(e,t){return t==null&&(t="-"),_.clean(e,{delimiter:t,alphanumeric:!0,downcase:!0})},startsWith:function(e,t){return e=""+e,t=""+t,t.length<=e.length&&e.substr(0,t.length)===t},endsWith:function(e,t){return e=""+e,t=""+t,t.length<=e.length&&e.substr(e.length-t.length)===t},sortByKey:function(e){var t;return t={},_.chain(e).map(function(e,t){return[t,e]}).sortBy(function(e){return e[0]}).each(function(e){return t[e[0]]=e[1]}),t},scrollTo:function(e,t,n){return e==null&&(e=0),e instanceof $&&(e=e.offset().top),$($.browser.webkit?document.body:document.documentElement).animate({scrollTop:e},t,n)},url:function(e,t){return e==null&&(e=""),t==null&&(t=location.protocol),_.endsWith(t,":")||(t+=":"),e.match(/^\w+:/)||(_.startsWith(e,"//")?e=location.protocol+e:_.startsWith(e,"/")?e=""+location.protocol+"//"+(location.host+e):e=location.href+e),e.replace(location.protocol,t)},relativeUrl:function(e){return e==null&&(e=""),_.url(e).replace(/^\w+:\/\/[^/]+/,"")},scrollbarSize:function(e){var t,n,r,i;return e==null&&(e="width"),n=$("<div><div/></div>").appendTo("body").css({position:"fixed",overflow:"hidden",left:-50,top:-50,width:50,height:50}),t=n.find("> div").css({height:"100%"}),r=t[e](),n.css({overflow:"scroll"}),i=t[e](),n.remove(),r-i},hasScrollbar:function(e){var t,n,r;return r=e.attr("style"),t=e.width(),n=e.css({overflow:"hidden"}).width(),r!=null?e.attr({style:r}):e.removeAttr("style"),t!==n},parseQuery:function(e,t){var n,r;return t==null&&(t=!0),e=_.clean(e,{downcase:t}),n=_.compact(e.replace(/^:+|:+$/g,"").split(":")),n.length>1?(n=_.map(n,function(e){return $.trim(e).match(/(?:^|^(.*)\s)(\S*)$/)}),r={},_.each(n,function(e,t){var i;return t<n.length-1?r[e[2]]=n[t+1][1]:(i=n[t-1][2],r[i]=(r[i]?r[i]+" ":"")+e[2])}),r):e},nextTick:function(e){return setTimeout(e,0)}},extensions:{Placeholder:{load:function(){var e;return e=$.fn.val,$.fn.val=function(t){var n;return n=$(this),t!=null?(t=""+t,n.is(".js-placeholder, .js-placeholder-password")&&!n.is(":focus")?t?(e.call(n,t),n.hasClass("js-placeholder-password")&&(n[0].type="password"),n.data({placeholderEmpty:!1})):(n.data({placeholderEmpty:!0}),e.call(n,n.data("placeholderText")),n.hasClass("js-placeholder-password")&&(n[0].type="text")):e.call(n,t),n):n.data("placeholderEmpty")?"":e.call(n)}},update:function(){return $(".js-placeholder, .js-placeholder-password").each(function(){var e,t,n;e=$(this);if(e.data("placeholderText")!=null&&!e.attr("placeholder")){t=e.hasClass("js-placeholder-password"),n=e.data("placeholderText"),t&&(e[0].type="password");if(!(t&&$.browser.msie&&$.browser.version.split(".")[0]<9))return e.data({placeholderEmpty:!1}),(!e.val()||e.val()===n)&&e.val(""),e.attr({placeholder:n,title:n}).focus(function(){return _.nextTick(function(){return t&&(e[0].type="password"),e.data("placeholderEmpty")&&e.val(""),e.data({placeholderEmpty:!1})})}).blur(function(){return _.nextTick(function(){if(!e.val())return e.val("")})})}})}},PopUp:{DURATION:0,FADE_DURATION:250,outside:!0,build:function(){var e;e=_.PopUp;if(!$("#js-pop-up-container").length)return $("body").append(e.$container=$("<div><div><div><div/></div></div></div>").attr({id:"js-pop-up-container"}).css({display:"none",position:"fixed",zIndex:999999,left:0,top:0,width:"100%",height:"100%",opacity:0,overflow:"auto"})),e.hide(),e.$container.find("> div").attr({id:"js-pop-up-table"}).css({display:"table",width:"100%",height:"100%"}),e.$container.find("> div > div").attr({id:"js-pop-up-table-cell"}).css({display:"table-cell",textAlign:"center",verticalAlign:"middle"}),e.$div=e.$container.find("> div > div > div").attr({id:"js-pop-up"}).css({display:"inline-block",position:"relative"}),e.$container.on("click",function(){return e.outside&&e.$div.find(".js-pop-up-outside").click(),e.outside=!0}),e.$div.on("click",function(){return e.outside=!1,!0}).on("click",".js-pop-up-hide",e.hide),$(document).keydown(function(t){if(e.$container.css("display")==="block"&&!$("body :focus").length){switch(t.keyCode){case 13:e.$div.find(".js-pop-up-enter").click();break;case 27:e.$div.find(".js-pop-up-esc").click();break;default:return!0}return!1}})},hide:function(e){var t;t=_.PopUp;if(t.$container!=null)return t.$container.stop().animate({opacity:0},isNaN(e)?t.fadeDuration:e,function(){return t.$container.css({display:"none"}),t.saveBodyStyle!=null?$("body").attr({style:t.saveBodyStyle}):$("body").removeAttr("style"),t.saveBodyStyle=null})},show:function(e,t){var n;t==null&&(t={}),n=_.PopUp,n.build(),t=_.extend({duration:n.DURATION,callback:null,fadeDuration:n.FADE_DURATION},t),n.$container.css("display")!=="block"&&(n.saveBodyStyle=$("body").attr("style")),_.hasScrollbar($("body"))&&$("body").css({marginRight:_.scrollbarSize()}),$("body").css({overflow:"hidden"}),$("body :focus").blur(),n.fadeDuration=t.fadeDuration,n.$div.empty(),e instanceof jQuery?n.$div.append(e):n.$div.html(e),_.update(),n.$container.stop().css({display:"block"}).animate({opacity:1},t.fadeDuration),n.timeout!=null&&clearTimeout(n.timeout);if(t.duration)return n.timeout=setTimeout(function(){return n.hide(),typeof t.callback=="function"?t.callback():void 0},t.duration)}},Search:{update:function(){return $(".js-search").each(function(){var e,t,n,r;n=$(this);if(n.data("searchCache")==null)return r=_.Search,n.data({searchCache:[],searchId:0,searchAjax:{},searchLastQ:null,searchPage:0,searchHoldHover:!1,search$Q:n.find(".js-search-q"),search$Results:n.find(".js-search-results")}),e=n.data("search$Q"),t=n.data("search$Results"),e.is(":focus")&&r.query(n),n.hover(function(){return n.data({searchHover:!0})},function(){n.data({searchHover:!1});if(!e.is(":focus")&&!n.data("searchHoldHover"))return t.css({display:"none"})}).mouseover(function(){return n.data({searchHoldHover:!1})}),e.blur(function(){return _.nextTick(function(){if(!n.data("searchHover"))return t.css({display:"none"})})}).focus(function(){return n.data({searchHoldHover:!1})}).keydown(function(t){switch(t.keyCode){case 13:n.find(".js-search-selected").click();break;case 38:r.select(n,"prev");break;case 40:r.select(n,"next");break;case 27:e.val()===""?(e.blur(),_.nextTick(function(){return r.query(n)})):_.nextTick(function(){return e.val(""),r.query(n)});break;default:return _.nextTick(function(){if(e.is(":focus"))return r.query(n)}),!0}return!1}).on("focus keyup change",function(){return r.query(n)}),t.on("mouseenter click",".js-search-result",function(i){var s;s=$(this),t.find(".js-search-result.js-search-selected").removeClass("js-search-selected"),s.addClass("js-search-selected");if(i.type==="click"){s.hasClass("js-search-prev")?(r.page(n,n.data("searchPage")-1,!0),n.data({searchHoldHover:!0})):s.hasClass("js-search-next")?(r.page(n,n.data("searchPage")+1),n.data({searchHoldHover:!0})):s.hasClass("js-search-submit")&&s.parents("form").submit();if(s.hasClass("js-search-hide"))return e.blur(),t.css({display:"none"})}})})},page:function(e,t,n){return e.each(function(){var e,r;return r=$(this),e=r.data("search$Results"),t=Math.min(e.find(".js-search-page").length-1,Math.max(t,0)),e.find(".js-search-selected").removeClass("js-search-selected"),e.find(".js-search-page").css({display:"none"}).eq(t).removeAttr("style").find(".js-search-result:not(.js-search-prev):not(.js-search-next)")[n?"last":"first"]().addClass("js-search-selected"),r.data("searchPage",t)})},query:function($searches,urlN){return urlN==null&&(urlN=1),$searches.each(function(){var $q,$results,$search,anotherSearch,callback,o,q,t,_base,_ref;o=_.Search,$search=$(this),$results=$search.data("search$Results"),$q=$search.data("search$Q"),callback=eval($search.data("searchCallback")),q=_.clean($q.val(),{downcase:!0}),t=(new Date).getTime(),$results.css({display:"block"}),anotherSearch=$search.data("searchUrl"+(urlN+1))!=null;if(!q&&$search.data("js-search-empty")==null)$results.css({display:"none"}).empty(),$search.removeClass("js-search-loading");else if(q!==$search.data("searchLastQ")||urlN>1)$search.addClass("js-search-loading"),callback($search,null,urlN),clearTimeout($search.data("searchTimeout")),typeof (_base=$search.data("searchAjax")).abort=="function"&&_base.abort(),$search.data("searchCache")[""+urlN+"_"+q]!=null?(anotherSearch||$search.removeClass("js-search-loading"),callback($search,$search.data("searchCache")[""+urlN+"_"+q],urlN),anotherSearch&&o.query($search,urlN+1)):$search.data("searchTimeout",setTimeout(function(){var check,handleData;handleData=function(e){$search.data("searchCache")[""+urlN+"_"+q]=e,check===$search.data("searchId")&&(_.clean($q.val())||$search.data("js-search-empty")!=null)&&(anotherSearch||$search.removeClass("js-search-loading"),callback($search,e,urlN));if(anotherSearch)return o.query($search,urlN+1)},check=$search.data({searchId:$search.data("searchId")+1}).data("searchId");if($search.data("searchJs")!=null)return handleData(eval($search.data("searchJs"))(q));if($search.data("searchUrl")!=null)return $search.data({searchAjax:$.getJSON($search.data("searchUrl"+(urlN===1?"":urlN)),{q:q},handleData)})},(_ref=$search.data("searchDelay"))!=null?_ref:0));return $search.data("searchLastQ",q)})},select:function(e,t){return e.each(function(){var e,n,r;r=_.Search,n=$(this),e=n.find(".js-search-page").eq(n.data("searchPage")),e.find(".js-search-selected").removeClass("js-search-selected")[t]().addClass("js-search-selected").length||e.find(".js-search-result")[t==="prev"?"first":"last"]().addClass("js-search-selected");if(e.find(".js-search-result.js-search-selected.js-search-prev").length)return r.page(n,n.data("searchPage")-1,!0);if(e.find(".js-search-result.js-search-selected.js-search-next").length)return r.page(n,n.data("searchPage")+1)})}},Tooltip:{mouse:{x:0,y:0},load:function(){var e;return e=_.Tooltip,$("body").mousemove(function(t){return e.mouse={x:t.pageX,y:t.pageY},$(".js-tooltip").each(function(){var t;t=$(this);if(t.data("tooltip$Div")!=null&&t.data("tooltipMouse")!=null)return t.data("tooltip$Div").css(e.position(t).home)})}).on("mouseenter",".js-tooltip:not([data-tooltip-no-hover])",function(){var t;return t=$(this),e.show(t),t.data({tooltipHover:!0})}).on("mouseleave",".js-tooltip:not([data-tooltip-no-hover])",function(){var t;return t=$(this),t.data({tooltipHover:!1}),e.hide(t)}).on("focus",".js-tooltip:input:not([data-tooltip-no-focus])",function(){return e.show($(this))}).on("blur",".js-tooltip:input:not([data-tooltip-no-focus])",function(){return e.hide($(this))})},divFor:function(e){var t,n,r;return n=_.Tooltip,e.data("tooltip$Div")||(e.parent().css({position:"static"})&&e.parent().css({position:"relative"}),e.data("tooltipMouse")!=null&&e.data({tooltipHoverable:null}),e.data(_.extend({tooltipPosition:"top",tooltipOffset:0,tooltipDuration:0},e.data())),t=$("<div><div/></div>").addClass("tooltip "+e.data("tooltipPosition")).css({display:"none",position:"absolute",zIndex:999999}),t.find("> div").html(e.data("tooltipHtml")).css({position:"relative"}),e.data({tooltip$Div:t}).parent().append(t),r=n.position(e),t.css(r.home).find("> div").css(_.extend({opacity:0},r.away)),e.data("tooltipHoverable")!=null?t.hover(function(){return _.Tooltip.show(e),e.data({tooltipHoverableHover:!0})},function(){return e.data({tooltipHoverableHover:!1}),_.Tooltip.hide(e)}):t.css({pointerEvents:"none","-webkit-user-select":"none","-moz-user-select":"none",userSelect:"none"})),e.data("tooltip$Div")},show:function(e){var t,n,r;n=_.Tooltip,t=n.divFor(e);if(!(e.data("tooltipNoHover")==null&&e.data("tooltipHover")||e.data("tooltipNoFocus")==null&&e.is(":input:focus")||e.data("tooltipHoverableHover")))return r=n.position(e),t.appendTo(e.parent()).css(_.extend({display:"block"},r.home)).find("> div").stop().animate({opacity:1,top:0,left:0},e.data("tooltipDuration"))},hide:function(e){var t,n,r;n=_.Tooltip;if(t=e.data("tooltip$Div"))if(!(e.data("tooltipNoHover")==null&&e.data("tooltipHover")||e.data("tooltipNoFocus")==null&&e.is(":input:focus")||e.data("tooltipHoverableHover")))return r=n.position(e),t.css(r.home).find("> div").stop().animate(_.extend({opacity:0},r.away),{duration:e.data("tooltipDuration"),complete:function(){return e.data({tooltip$Div:null}),$(this).parent().remove()}})},position:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;u=_.Tooltip,t=e.data("tooltip$Div"),n=e.parent(),a=e.data("tooltipOffset"),s=t.outerWidth(),i=t.outerHeight(),f=n.scrollLeft(),l=n.scrollTop(),e.data("tooltipMouse")!=null?(h=u.mouse.x-e.parent().offset().left+f,d=u.mouse.y-e.parent().offset().top+l,v=c=0):(p=e.position(),h=p.left+f+parseInt(e.css("marginLeft")),d=p.top+l+parseInt(e.css("marginTop")),v=e.outerWidth(),c=e.outerHeight()),o={left:h,top:d},r={};switch(e.data("tooltipPosition")){case"top":o.left+=(v-s)/2,o.top-=i,r.top=-a;break;case"right":o.left+=v,o.top+=(c-i)/2,r.left=a;break;case"bottom":o.left+=(v-s)/2,o.top+=c,r.top=a;break;case"left":o.left-=s,o.top+=(c-i)/2,r.left=-a}return{home:o,away:r}},correct:function(e){var t,n;n=_.Tooltip,t=e.data("tooltip$Div");if(t)return e.css("display")==="none"?e.mouseleave().blur():(t.find("> div").html(e.data("tooltipHtml")),t.css(_.Tooltip.position(e).home))},remove:function(e){var t;return(t=e.data({tooltipHover:false,tooltipHoverableHover:false}).removeClass("js-tooltip").data("tooltip$Div"))!=null?t.remove():void 0}},State:{HEADER:"X-Chromeless",xhr:{},cache:{},data:{},load:function(){var e;return e=_.State,history.state!=null&&history.replaceState(!0,null),$(window).on("popstate",function(t){return t.originalEvent.state!=null?e.push(location.href):history.replaceState(!0,null)}),$("body").on("click",".js-state",function(){var t;return t=$(this),e.push(t.data("stateUrl")?t.data("stateUrl"):t.attr("href"),t.data("stateProtocol")),!1})},set:function(e,t){var n;return t==null&&(t=location.href),n=_.State,t=_.url(t),n.cache[t]!=null?_.extend(n.cache[t],e):n.cache[t]=e},get:function(e,t){return t==null&&(t=location.href),_.State.cache[_.url(t)][e]},reset:function(e){return e==null&&(e=location.href),delete _.State.cache[_.url(e)]},resetAll:function(){return _.State.cache={}},unescapeScripts:function(e){var t;return t=/<script([\s\S]*?)>([\s\S]*?)<\/script>/g,e.replace(t,function(e,t,n){return"<script"+t+">"+$("<div>").html(n).text()+"</script>"})},push:function(e,t){var n,r,i,s;t==null&&(t=location.protocol),n=_.State,e=_.url(e,t);if(history.pushState!=null&&!n.refresh&&((i=_.State.data[e])!=null?!i.refresh:!void 0)&&_.startsWith(e,location.protocol))return typeof (r=n.xhr).abort=="function"&&r.abort(),n.clear(n.cache[e],e),n.cache[e]!=null&&n.cache[e].cache!==!1?n.change(e):(n.before(n.cache[e],e),n.xhr=$.ajax(e,{data:n.data,success:function(t){var r,i,s;s=null,i={},$(t.replace(/script/gi,"save-state-script")).each(function(){var e,t;e=$(this);if(!(e[0]instanceof Text))if((t=e.attr("id"))||e.is("title")){i[t&&"#"+t||"title"]=n.unescapeScripts(e.html().replace(/save-state-script/g,"script"));if(t)return s=!0}else if(s==null)return s=!1});if(r=i["#chromeless-request-url"])e=r;return s?(n.set(i,e),n.after(n.cache[e],e),n.change(e)):location.assign(e)},beforeSend:function(e){return e.setRequestHeader(n.HEADER,1)},error:function(){return location.assign(e)}}));if((s=n.cache[e])!=null?!s.soft:!void 0)return location.assign(e)},change:function(e){var t,n,r;return r=_.State,n=r.cache[e],t=n.replace?"replaceState":"pushState",location.href!==e&&history[t](!0,null,e),r.parse(n,e),_.update()},clear:function(){},before:function(){},after:function(){},parse:function(){}},Lazy:{TOLERANCE:100,load:function(){return $(window).on("scroll resize",_.Lazy.update)},update:function(){return _.nextTick(function(){return $("img.js-lazy").each(function(){var e,t,n,r,i,s,o;e=$(this),s=_.reduce(e.parents(),function(e,t){return e&&$(t).css("display")!=="none"&&$(t).css("visibility")!=="hidden"},!0),t=$(window).scrollTop()+$(window).outerHeight(),r=(o=e.data("lazyTolerance"))!=null?o:_.Lazy.TOLERANCE,n=e.offset().top-r;if(s&&t>=n)return i=e.data("lazyUrl"),e.removeClass("js-lazy").attr("src",i)})})}},Konami:function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p;return t==null&&(t={}),t=_.extend({onlyOnce:!1,code:"38,38,40,40,37,39,37,39,66,65,13",touchCode:"up,up,down,down,left,right,left,right,tap,tap,tap"},t),o=[],c=[],f=!1,u=a=r=i=0,s=function(n){o.push(n.keyCode);if(_.endsWith(o+"",t.code))return t.onlyOnce&&$(document).off("keydown",s),o=[],n.preventDefault(),e()},p=function(e){var t,n;e=e.originalEvent;if(e.touches.length===1)return t=e.touches[0],u=t.screenX,a=t.screenY,f=n=!0},h=function(e){var t,s,o,l;e=e.originalEvent;if(e.touches.length===1&&f)return o=e.touches[0],r=o.screenX-u,i=o.screenY-a,s=r>0?"right":"left",t=i>0?"down":"up",l=Math.abs(r)>Math.abs(i)?s:t,c.push(l),f=!1,n(e)},l=function(e){e=e.originalEvent;if(e.touches.length===0&&f)return c.push("tap"),n(e)},n=function(n){if(_.endsWith(c+"",t.touchCode))return t.onlyOnce&&($(document).off("touchmove",h),$(document).off("touchend",l)),c=[],n.preventDefault(),e()},$(document).on("keydown",s),$(document).on("touchstart",p),$(document).on("touchmove",h),$(document).on("touchend",l)},Cookie:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p;n==null&&(n={});if(typeof e=="object"){for(u in e)l=e[u],_.Cookie(u,l,t);return _.Cookie()}if(typeof e=="string"&&t!==void 0)return t===null&&(n.expires=-1),t||(t=""),a=[],n.expires&&a.push("; Expires="+(n.expires.toGMTString!=null?n.expires.toGMTString():(new Date((new Date).getTime()+n.expires*1e3*60*60*24)).toGMTString())),n.path&&a.push("; Path="+n.path),n.domain&&a.push("; Domain="+n.domain),n.httpOnly&&a.push("; HttpOnly"),n.secure&&a.push("; Secure"),s=encodeURIComponent(e),o=encodeURIComponent(t),document.cookie=""+s+"="+o+a.join(""),_.Cookie();i={};if(document.cookie){f=decodeURIComponent(document.cookie).split(/\s*;\s*/);for(c=0,h=f.length;c<h;c++){r=f[c],p=/^([^=]*)\s*=\s*(.*)$/.exec(r),u=p[1],l=p[2];if(typeof e=="string"&&e===u)return l;e==null&&(i[u]=l)}}return e?null:i}},plugins:{backboneLink:function(e,t){return t==null&&(t={}),$(this).each(function(){var n;return n=$(this).find("[data-backbone-link-attr]"),(n.length?n:$(this)).each(function(){var n,r,i,s,o,u;return n=$(this),n.backboneUnlink(),n.data({backboneLinkModel:e}),r=n.data("backboneLinkAttr")||t.attr,s=(o=n.data("backboneLinkSave"))!=null?o:(u=t.save)!=null?u:!0,i=n.is(":checkbox"),n.data({backboneLinkInputChange:function(){var t,o;o=e.get(r),t=i?n.is(":checked"):n.val();if(r==="id"||_.endsWith(r,"_id")||_.endsWith(r,"Id"))t=t?parseInt(t):null;e.set(r,t===""?null:t);if(s&&t!==o)return e.save()}}),n.data({backboneLinkModelChange:function(){var t,s,o;o=n.is(":input")?"val":"text",s=i?n.is(":checked"):n[o](),t=e.get(r),t=t===null?"":t;if(t!==s)return i?n.prop({checked:!!t}):n[o](t)}}),n.is(":input")&&n.on("change",n.data("backboneLinkInputChange")),e.on("change:"+r,n.data("backboneLinkModelChange"),this).trigger("change:"+r)})})},backboneUnlink:function(){return $(this).each(function(){var e,t;e=$(this),t=e.data("backboneLinkModel");if(t)return e.off("change",e.data("backboneLinkInputChange")),t.off(null,e.data("backboneLinkModelChange"))})}}},_.mixin(Extrascore.mixins),_.extend(_,Extrascore.extensions),_.extend($.fn,Extrascore.plugins),_.init(Extrascore.extensions))}).call(this);